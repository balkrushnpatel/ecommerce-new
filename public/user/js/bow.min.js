$('.shop-layout').click(function(){
	var id = $(this).attr('data-id');
	$('.shop-layout').removeClass('active');
	$(this).addClass('active');
	$('#box-view').removeClass('hidden');
	$('#single-box-view').removeClass('hidden');
	if(id == 'box-view'){ 
		$('#single-box-view').addClass('hidden'); 
	}
	if(id == 'single-box-view'){
		$('#box-view').addClass('hidden'); 
	}
});

$('#filtter').change(function(){
	var filter = $(this).val(); 
	var catId = $('.filter-items a.active').attr('data-cat_id');
	var price = $('.price_filter a.active').attr('data-price');
	filterProduct(catId,filter,price); 
});
$('.category-filter').click(function(){
	var catId = $(this).attr('data-cat_id');
	var filter = $('#filtter').val(); 
	var price = $('.price_filter a.active').attr('data-price');
	$('.category-filter').removeClass('active');
	$(this).addClass('active');
	filterProduct(catId,filter,price); 
});
$('.price_filter').click(function(){
	var price = $(this).attr('data-price');
	var filter = $('#filtter').val(); 
	var catId = $('.filter-items a.active').attr('data-cat_id');
	$('.price_filter').removeClass('active');
	$(this).addClass('active');
	filterProduct(catId,filter,price); 
});
$('.filter-clean').click(function(){ 
	$('.category-filter').removeClass('active');
	$('#filtter').val(''); 
	filterProduct();
});

$('.btn-cart').click(function(){ 
	if(!$(this).hasClass("disabled")){ 
		var id = $(this).attr('data-id');
		var color = $('.cust-color.active').data('color');
		var option = $('#option').val();
		var qty = $('#qty').val();
		$.ajax({
			url: APP_URL + '/cart/product',
			data : {
				'color':color,
				'option':option,
				'qty':qty,
				'id':id
			},
			beforeSend: function() { 
			},
			success: function(res) {
				headerCart();
			}
		});
	}
}); 
$( document ).delegate( ".remove-product", "click", function() { 	  
	var id = $(this).attr('data-id'); 
	$.ajax({
		url: APP_URL + '/cart/remove-product',
		data : { 
			'id':id
		},
		beforeSend: function() { 
		},
		success: function(res) {
			headerCart();
		}
	}); 
}); 
$( document ).delegate( ".cart-qty-btn", "click", function() { 	  
	var id = $(this).attr('data-id'); 
	var btn = $(this).attr('data-btn'); 
	var one = '1';
	var qty = $('#product_qty_'+id).val(); 
	var maxQty = $('#product_qty_'+id).attr('max'); 
	if(btn == '+'){
		qty = (+qty + +one);
	}else{
		qty = (qty - one);
	}
	if(qty > 0){
		$('#product_qty_'+id).val(qty); 
		$.ajax({
			url: APP_URL + '/cart/qty-add-minus',
			data : { 
				'id':id,
				'qty':qty,
			},
			beforeSend: function() { 
			},
			success: function(res) {
				cartTable();
				headerCart();
			}
		}); 
	}
}); 
$( document ).delegate( ".clear-cart", "click", function() { 	  
	var id = $(this).attr('data-id'); 
	$.ajax({
		url: APP_URL + '/cart/clear',
		data : { 
			'id':id
		},
		beforeSend: function() { 
		},
		success: function(res) { 
			/*handleResponse(res);*/
			setTimeout(function(){ location.reload(); }, 2000);
		}
	}); 
}); 
$( document ).delegate( "#coupon_btn", "click", function() { 	  
	var couponCode = $('#coupon_code').val();
	var totalAmount = $('#final_total_text').val();
	console.log(couponCode);
	if(couponCode != ''){
		$.ajax({
		url: APP_URL + '/cart/apply-coupon',
		data : { 
			'code':couponCode,
			'totalAmount':totalAmount
		},
		beforeSend: function() { 
		},
		success: function(res) { 
			if(res.status == 2){ 
				$('#coupon_code').attr('readonly',true);
				$('#discount').html(res.discountTp);
				$('#discount_text').val(res.discount);
				$('#final_total').html(res.total);
				$('#final_total_text').val(res.total);
				$('#discount_type').val(res.discountType);
			}
		}
	}); 
	}else{

	}
}); 
$( document ).delegate( "#shipping-toggle", "click", function() {  
	$('.ship_diff_address').val(' ');
	if($(this).is(":checked")){	 
		$('.ship_diff_address').attr('required',true);
	}else{ 
		$('.ship_diff_address').attr('required',false);
	}
}); 

$( document ).delegate( ".shipping-type", "change", function() { 	  
	var val = $(this).val(); 
	var mainTotal = $('#total_text').val();
	var total = (+mainTotal + +val);
	$('#final_total').html(total);
	$('#final_total_text').val(total);
}); 
$("#headerSearch").autocomplete({
	source: function(request, response) {
		var catId = $("#category").val();
		$.ajax({
			url: APP_URL + '/headersearch',
			dataType: "json",
			data: {
				term : request.term,
				catId:catId,
			},
			success: function(data) {
				response(data);
			}
		});
	},
	select: function( event, ui ) {
		$('.btn-search').trigger('click');
	}
});
function filterProduct(category_id = '',filter='',price=''){
	$.ajax({
		url: APP_URL + '/product/get-list',
		data : {
			'category_id':category_id,
			'filter':filter,
			'price':price
		},
		beforeSend: function() { 
		},
		success: function(res) {
			$('#product-list-wrap').html(res); 
		}
	});
}
function headerCart(){
	$.ajax({
		url: APP_URL + '/cart/header-box',
		data : { 
		},
		beforeSend: function() { 
		},
		success: function(res) {
			$('#header-cart').html(res); 
		}
	});
}

function cartTable(){
	$.ajax({
		url: APP_URL + '/cart/view-cart',
		data : { 
		},
		beforeSend: function() { 
		},
		success: function(res) {
			$('#view-cart').html(res); 
		}
	});
}

function handleResponse(res) { 
    if (res.success) {
        notify(res.message,'success','bottom','right');
        return true;
    } 
    if (res.status === 2) { 
        notify(res.message,'success','bottom','right');
        return true;
    } else if (res.status === 3) {
        notify(res.message,'warning','bottom','right');
        return true;
    } else if (res.status === 401) {
        location.reload();
    } else if (res.status === 422 || res.status === 1) {
        return handleFormErrors(res);
    } else if (res.status === 419) {         
        notify(res.message,'warning','bottom','right');
        return true;
    } else if (jQuery.inArray(res.status, [403, 404]) >= 0) {
        var msg = (res.status === 404) ? 'The record does not exist. If you are repeatedly getting this error contact system admin for more details.' : res.responseJSON.message;
        notify(msg,'warning','bottom','right');
        return true;
    }
}